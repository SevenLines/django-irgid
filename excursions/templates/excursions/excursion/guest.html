{% load thumbnail %}
<h2 id="excursion-title" style="margin-bottom: 0.25em">
    {{ current_excursion.title|default:"..." }}
</h2>
<hr>

<!-- ГАЛЕРЕЯ -->
<!-- КОНТЕЙНЕР С ИЗОБРАЖЕНИЕМ -->

{% if gallery %}
    <div class="excursion-gallery guest">
        {% thumbnail current_excursion.img_preview 0x150 as thumb %}
        {% thumbnail current_excursion.img_preview 1024x400 as thumb_big %}
        <div class="excursion-gallery-item active"
             data-thumb-src="{{ thumb_big.url }}" data-src="{{ current_excursion.img_preview.url }}">
            <div>
                <img class="lazy" data-original="{{ thumb.url }}"/>
            </div>
        </div>
        {% for img in gallery %}
            {% thumbnail img.image 0x150 as thumb %}
            {% thumbnail img.image 1024x400 as thumb_big %}
            <div class="excursion-gallery-item"
                 data-thumb-src="{{ thumb_big.url }}" data-src="{{ img.image.url }}">
                <div>
                    <img class="lazy active" data-original="{{ thumb.url }}"/>
                </div>
            </div>
        {% endfor %}
    </div>
{% endif %}


{% if current_excursion.img_preview %}
    <div class="excursion-preview-container">
        <a href="{{ current_excursion.img_preview.url }}" style="height:400px;">
            {% thumbnail current_excursion.img_preview 1024x400 as thumb %}
            <img class="lazy fadein main-image" data-original="{{ thumb.url }}"/>
        </a>
    </div>
    {#        <hr>#}
{% endif %}
<!-- конец КОНТЕЙНЕР С ИЗОБРАЖЕНИЕМ -->
<hr>
    <div style="clear:right"></div>


<!-- конец ГАЛЕРЕЯ -->

<!-- ОПИСАНИЕ -->
<div id="excursion-description">
    {{ current_excursion.description|safe|default:"..." }}
</div>
<!-- конец ОПИСАНИЕ -->

<!-- ЦЕНЫ -->
{% if current_excursion.priceList %}
    <h3>Цены:</h3>
    <div id="excursion-price-list">
        <table class="table">
            <thead>
            <tr>
                <td>Кол-во человек в группе</td>
                {% for k, v in current_excursion.price_list_rendered %}
                    <td>{{ k }}</td>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
            <tr>
                <td>Цена в расчете на человека, руб.</td>
                {% for k, v in current_excursion.price_list_rendered %}
                    <td>{{ v }}</td>
                {% endfor %}
            </tr>
            </tbody>
        </table>
    </div>
{% endif %}
<!-- конец ЦЕНЫ -->

<script>
    var galleryItems = $(".excursion-gallery-item");
    galleryItems.on("click", function () {
        $(".main-image").attr("src", this.dataset.thumbSrc)
                .parent().attr("href", this.dataset.src);
        galleryItems.removeClass("active");
        $(this).addClass("active");
    });
</script>

